var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function s(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function r(n,...e){if(null==n)return t;const o=n.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}function c(t){let n;return r(t,(t=>n=t))(),n}function l(t,n,e){t.$$.on_destroy.push(r(n,e))}function u(t,n,e,o){return t[1]&&o?function(t,n){for(const e in n)t[e]=n[e];return t}(e.ctx.slice(),t[1](o(n))):e.ctx}function a(t,n,e,o,i,s,r){const c=function(t,n,e,o){if(t[2]&&o){const i=t[2](o(e));if(void 0===n.dirty)return i;if("object"==typeof i){const t=[],e=Math.max(n.dirty.length,i.length);for(let o=0;o<e;o+=1)t[o]=n.dirty[o]|i[o];return t}return n.dirty|i}return n.dirty}(n,o,i,s);if(c){const i=u(n,e,o,r);t.p(i,c)}}function f(t){return null==t?"":t}function d(t,n,e=n){return t.set(e),n}const p="undefined"!=typeof window;let x=p?()=>window.performance.now():()=>Date.now(),h=p?t=>requestAnimationFrame(t):t;const y=new Set;function m(t){y.forEach((n=>{n.c(t)||(y.delete(n),n.f())})),0!==y.size&&h(m)}function $(t,n){t.appendChild(n)}function g(t,n,e){t.insertBefore(n,e||null)}function w(t){t.parentNode.removeChild(t)}function v(t){return document.createElement(t)}function E(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function b(t){return document.createTextNode(t)}function S(){return b(" ")}function _(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function M(t){return function(n){return n.preventDefault(),t.call(this,n)}}function O(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function I(t,n,e,o){t.style.setProperty(n,e,o?"important":"")}let T;function D(t){T=t}function L(){const t=function(){if(!T)throw new Error("Function called outside component initialization");return T}();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const i=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);o.slice().forEach((n=>{n.call(t,i)}))}}}function k(t,n){const e=t.$$.callbacks[n.type];e&&e.slice().forEach((t=>t(n)))}const A=[],C=[],X=[],B=[],P=Promise.resolve();let j=!1;function N(t){X.push(t)}let V=!1;const Y=new Set;function R(){if(!V){V=!0;do{for(let t=0;t<A.length;t+=1){const n=A[t];D(n),U(n.$$)}for(D(null),A.length=0;C.length;)C.pop()();for(let t=0;t<X.length;t+=1){const n=X[t];Y.has(n)||(Y.add(n),n())}X.length=0}while(A.length);for(;B.length;)B.pop()();j=!1,V=!1,Y.clear()}}function U(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(N)}}const z=new Set;let Z;function G(){Z={r:0,c:[],p:Z}}function q(){Z.r||o(Z.c),Z=Z.p}function F(t,n){t&&t.i&&(z.delete(t),t.i(n))}function W(t,n,e,o){if(t&&t.o){if(z.has(t))return;z.add(t),Z.c.push((()=>{z.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}function H(t){t&&t.c()}function J(t,e,s){const{fragment:r,on_mount:c,on_destroy:l,after_update:u}=t.$$;r&&r.m(e,s),N((()=>{const e=c.map(n).filter(i);l?l.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(N)}function K(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function Q(t,n){-1===t.$$.dirty[0]&&(A.push(t),j||(j=!0,P.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function tt(n,i,s,r,c,l,u=[-1]){const a=T;D(n);const f=n.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:e(),dirty:u,skip_bound:!1};let d=!1;if(f.ctx=s?s(n,i.props||{},((t,e,...o)=>{const i=o.length?o[0]:e;return f.ctx&&c(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),d&&Q(n,t)),e})):[],f.update(),d=!0,o(f.before_update),f.fragment=!!r&&r(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(w)}else f.fragment&&f.fragment.c();i.intro&&F(n.$$.fragment),J(n,i.target,i.anchor),R()}D(a)}class nt{$destroy(){K(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const et=[];function ot(n,e=t){let o;const i=[];function r(t){if(s(n,t)&&(n=t,o)){const t=!et.length;for(let t=0;t<i.length;t+=1){const e=i[t];e[1](),et.push(e,n)}if(t){for(let t=0;t<et.length;t+=2)et[t][0](et[t+1]);et.length=0}}}return{set:r,update:function(t){r(t(n))},subscribe:function(s,c=t){const l=[s,c];return i.push(l),1===i.length&&(o=e(r)||t),s(n),()=>{const t=i.indexOf(l);-1!==t&&i.splice(t,1),0===i.length&&(o(),o=null)}}}}function it(t){return"[object Date]"===Object.prototype.toString.call(t)}function st(t,n,e,o){if("number"==typeof e||it(e)){const i=o-e,s=(e-n)/(t.dt||1/60),r=(s+(t.opts.stiffness*i-t.opts.damping*s)*t.inv_mass)*t.dt;return Math.abs(r)<t.opts.precision&&Math.abs(i)<t.opts.precision?o:(t.settled=!1,it(e)?new Date(e.getTime()+r):e+r)}if(Array.isArray(e))return e.map(((i,s)=>st(t,n[s],e[s],o[s])));if("object"==typeof e){const i={};for(const s in e)i[s]=st(t,n[s],e[s],o[s]);return i}throw new Error(`Cannot spring ${typeof e} values`)}function rt(t,n={}){const e=ot(t),{stiffness:o=.15,damping:i=.8,precision:s=.01}=n;let r,c,l,u=t,a=t,f=1,d=0,p=!1;function $(n,o={}){a=n;const i=l={};if(null==t||o.hard||g.stiffness>=1&&g.damping>=1)return p=!0,r=x(),u=n,e.set(t=a),Promise.resolve();if(o.soft){const t=!0===o.soft?.5:+o.soft;d=1/(60*t),f=0}return c||(r=x(),p=!1,c=function(t){let n;return 0===y.size&&h(m),{promise:new Promise((e=>{y.add(n={c:t,f:e})})),abort(){y.delete(n)}}}((n=>{if(p)return p=!1,c=null,!1;f=Math.min(f+d,1);const o={inv_mass:f,opts:g,settled:!0,dt:60*(n-r)/1e3},i=st(o,u,t,a);return r=n,u=t,e.set(t=i),o.settled&&(c=null),!o.settled}))),new Promise((t=>{c.promise.then((()=>{i===l&&t()}))}))}const g={set:$,update:(n,e)=>$(n(a,t),e),subscribe:e.subscribe,stiffness:o,damping:i,precision:s};return g}function ct(n){let e;return{c(){e=v("div"),e.textContent="this is an image element",O(e,"class","svelte-108a3i5")},m(t,n){g(t,e,n)},p:t,i:t,o:t,d(t){t&&w(e)}}}class lt extends nt{constructor(t){super(),tt(this,t,null,ct,s,{})}}const ut=ot({x:0,y:0}),at=ot(1),ft=ot(1),dt=ot({x:0,y:0});class pt{constructor(t,n,e,o){this.id="",this.position={x:0,y:0},this.scale={x:10,y:10},this.component=lt,this.inSelectionRange=!1,this.selected=!1,this.id=t,this.position=n,this.scale=e,this.component=o}}const xt=ot([new pt("asdfsjakldfldsa",{x:0,y:0},{x:100,y:100},lt),new pt("asdfsjakldflddsaf",{x:200,y:200},{x:300,y:300},lt),new pt("asdfsjakldfldsa",{x:300,y:0},{x:100,y:100},lt),new pt("asdfsjakldfldsa",{x:400,y:0},{x:100,y:100},lt),new pt("asdfsjakldfldsa",{x:500,y:0},{x:100,y:100},lt)]);let ht=[];const yt={SELECT:"item.select",SELECT_ADDITIVE:"item.select_additive",MOVE:"item.move"},mt={BOX_SELECT:"canvas.box_select",BOX_SELECT_ADDITIVE:"canvas.box_select_additive",PAN:"canvas.pan",ZOOM_IN:"canvas.zoom_in",ZOOM_OUT:"canvas.zoom_out"},$t={SAVE:"shortcut.save",ALIGN_TOP:"shortcut.align_top"};class gt{constructor(t,n){this.input=[],this.onDown=()=>{},this.onUp=()=>{},this.operation=t,this.input=n}setDown(t){return this.onDown=t,this}setUp(t){return this.onUp=t,this}}let wt=[new gt($t.ALIGN_TOP,["control","arrowup"]),new gt(mt.BOX_SELECT,["leftMouse"]),new gt(mt.BOX_SELECT_ADDITIVE,["shift","leftMouse"]),new gt(mt.PAN,["alt","rightMouse"]),new gt(mt.PAN,["middleMouse"]),new gt(mt.ZOOM_IN,["scrollUp"]),new gt(mt.ZOOM_OUT,["scrollDown"]),new gt(yt.MOVE,["leftMouse"]),new gt(yt.SELECT,["leftMouse"]),new gt(yt.SELECT_ADDITIVE,["shift","leftMouse"])];function vt(t,n,e=null,o=null,i=null){let s=function(){let t={x:0,y:0},n=1;return t=c(ut),n=c(at),{offset:t,scale:n}}();return null!=e&&(s.offset.x=e),null!=o&&(s.offset.y=o),null!=i&&(s.scale=i),{x:(t-s.offset.x)/s.scale,y:(n-s.offset.y)/s.scale}}class Et{static addEach(t,n){if(null!=t&&null!=n)return{x:t.x+n.x,y:t.y+n.y}}static subtractEach(t,n){if(null!=t&&null!=n)return{x:t.x-n.x,y:t.y-n.y}}static multiplyBoth(t,n){if(null!=t&&null!=n)return{x:t.x*n,y:t.y*n}}static multiplyEach(t,n){if(null!=t&&null!=n)return{x:t.x*n.x,y:t.y*n.y}}static getLength(t){if(null!=t)return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}}function bt(t,n){let e=!1;return t&&n&&(e=!(t.right<n.left||t.left>n.right||t.bottom<n.top||t.top>n.bottom)),e}const St=["leftMouse","middleMouse","rightMouse"];function _t(t,n){ht.includes(t)||ht.push(t)}function Mt(t){ht.includes(t)&&ht.splice(ht.indexOf(t),1)}function Ot(t,n=ht){let e=wt.filter((n=>n.operation==t));for(let o of e){if(n.toString()==o.input.toString())return!0;for(let e of wt.filter((n=>n.operation!=t)))if(n.toString().includes(e.input.toString()))return!1;if(n.toString().includes(o.input.toString()))return!0}}function It(t,n){if(wt.find((t=>t.input.toString()==ht.toString())))try{n.preventDefault()}catch(t){console.warn('Error preventing default for input "',wt.find((t=>t.input.toString()==ht.toString())).operation,'" this may be a bug, or may be fine',"\n",t)}}function Tt(t){let n=wt.filter((t=>t.operation.startsWith("shortcut")));for(let e=0;e<n.length;e++)n[e].input.toString()==ht.toString()&&(n[e].onUp(),It(0,t))}function Dt(t){let n=t;return n=n.toLowerCase(),n}function Lt(){for(let t of c(xt).filter((t=>t.selected)))t.selected=!1;xt.update((t=>t))}function kt(n){let e,i,s,r,c,l,u,a,f,d,p,x;return{c(){e=E("svg"),i=E("defs"),s=E("filter"),r=E("feGaussianBlur"),c=E("feBlend"),l=E("rect"),O(r,"result","blurOut"),O(r,"stdDeviation","10"),O(c,"in","SourceGraphic"),O(c,"in2","blurOut"),O(c,"mode","normal"),O(s,"id","selection-glow"),O(s,"x","-10"),O(s,"y","-10"),O(s,"width","200"),O(s,"height","200"),O(l,"id","selection-box"),O(l,"x","3"),O(l,"y","3"),O(l,"width",u=Math.max(3,n[1].x-6)),O(l,"height",a=Math.max(3,n[1].y-6)),O(l,"rx","5"),O(l,"filter","url(#selection-glow)"),O(l,"class","svelte-vbnion"),O(e,"id","selection"),O(e,"width",f=Math.max(6,n[1].x)),O(e,"height",d=Math.max(6,n[1].y)),I(e,"transform","translate("+n[2].x+"px, "+n[2].y+"px)"),I(e,"visibility",n[0]),O(e,"class","svelte-vbnion")},m(t,o){g(t,e,o),$(e,i),$(i,s),$(s,r),$(s,c),$(e,l),p||(x=[_(window,"mousemove",n[3]),_(window,"mouseup",n[4])],p=!0)},p(t,[n]){2&n&&u!==(u=Math.max(3,t[1].x-6))&&O(l,"width",u),2&n&&a!==(a=Math.max(3,t[1].y-6))&&O(l,"height",a),2&n&&f!==(f=Math.max(6,t[1].x))&&O(e,"width",f),2&n&&d!==(d=Math.max(6,t[1].y))&&O(e,"height",d),4&n&&I(e,"transform","translate("+t[2].x+"px, "+t[2].y+"px)"),1&n&&I(e,"visibility",t[0])},i:t,o:t,d(t){t&&w(e),p=!1,o(x)}}}function At(t,n,e){let o,i,s,r;l(t,xt,(t=>e(12,i=t))),l(t,dt,(t=>e(8,s=t))),l(t,ft,(t=>e(9,r=t)));let{visibility:c="hidden"}=n,u={x:0,y:0},a={x:0,y:0},f={x:0,y:0},d=!1;function p(t,n,o){let s=vt(t,n),r=function(t,n){let e={x:0,y:0},o={x:0,y:0};return t.x>n.x?(e.x=n.x,o.x=t.x-n.x):(e.x=t.x,o.x=n.x-t.x),t.y>n.y?(e.y=n.y,o.y=t.y-n.y):(e.y=t.y,o.y=n.y-t.y),{x:e.x,y:e.y,width:o.x,height:o.y}}(u,s);e(6,a={x:r.width,y:r.height}),e(7,f={x:r.x,y:r.y}),e(0,c="visible"),function(t){for(let t of i)bt(new DOMRect(f.x,f.y,a.x,a.y),new DOMRect(t.position.x,t.position.y,t.scale.x,t.scale.y))?t.inSelectionRange=!0:t.inSelectionRange=!1;xt.update((t=>t))}()}function x(){for(let t of i)t.inSelectionRange&&(t.selected=!0,t.inSelectionRange=!1);xt.update((t=>t)),d=!1,e(0,c="hidden")}let h={x:0,y:0};return t.$$set=t=>{"visibility"in t&&e(0,c=t.visibility)},t.$$.update=()=>{896&t.$$.dirty&&e(2,o=function(t,n,e=null,o=null,i=null){let s;return s={offset:{x:0,y:0},scale:1},null!=e&&(s.offset.x=e),null!=o&&(s.offset.y=o),null!=i&&(s.scale=i),{x:t*s.scale+s.offset.x,y:n*s.scale+s.offset.y}}(f.x,f.y,s.x,s.y,r)),576&t.$$.dirty&&e(1,h=Et.multiplyBoth(a,r))},[c,h,o,function(t){!function(t){d&&(Ot(mt.BOX_SELECT)||Ot(mt.BOX_SELECT_ADDITIVE)?p(t.clientX,t.clientY):x())}(t)},function(t){d&&ht.toString()!=wt.find((t=>t.operation==mt.BOX_SELECT||mt.BOX_SELECT_ADDITIVE)).input.toString()&&x()},(t,n,o)=>function(t,n,o){d=!0,u=vt(t,n),e(6,a={x:0,y:0}),e(7,f={x:0,y:0}),e(0,c="hidden"),o||Lt()}(t,n,o),a,f,s,r]}class Ct extends nt{constructor(t){super(),tt(this,t,At,kt,s,{visibility:0,backgroundStartBoxSelection:5})}get backgroundStartBoxSelection(){return this.$$.ctx[5]}}function Xt(n){let e;return{c(){e=v("div"),e.innerHTML='<svg><rect width="100px" height="100px"></rect></svg>',O(e,"id","selection"),O(e,"class","svelte-1crbpd9")},m(t,n){g(t,e,n)},p:t,i:t,o:t,d(t){t&&w(e)}}}class Bt extends nt{constructor(t){super(),tt(this,t,null,Xt,s,{})}}const Pt=t=>({itemId:1&t,position:4&t,scale:8&t}),jt=t=>({class:"slot",itemId:t[0],position:t[2],scale:t[3]});function Nt(t){let n,e,i,s,r;const c=t[15].default,l=function(t,n,e,o){if(t){const i=u(t,n,e,o);return t[0](i)}}(c,t,t[14],jt),d=l||function(t){let n;return{c(){n=b("This item has no type")},m(t,e){g(t,n,e)},d(t){t&&w(n)}}}();return{c(){n=v("div"),d&&d.c(),O(n,"id","root"),I(n,"--positionX",t[2].x+"px"),I(n,"--positionY",t[2].y+"px"),I(n,"--scaleX",t[3].x+"px"),I(n,"--scaleY",t[3].y+"px"),I(n,"--canvasZoom",t[4]),O(n,"class",e=f(t[1])+" svelte-jp2xja")},m(e,o){g(e,n,o),d&&d.m(n,null),i=!0,s||(r=[_(window,"mousemove",t[6]),_(window,"mouseup",t[7]),_(n,"mousedown",t[5])],s=!0)},p(t,[o]){l&&l.p&&16397&o&&a(l,c,t,t[14],o,Pt,jt),(!i||4&o)&&I(n,"--positionX",t[2].x+"px"),(!i||4&o)&&I(n,"--positionY",t[2].y+"px"),(!i||8&o)&&I(n,"--scaleX",t[3].x+"px"),(!i||8&o)&&I(n,"--scaleY",t[3].y+"px"),(!i||16&o)&&I(n,"--canvasZoom",t[4]),(!i||2&o&&e!==(e=f(t[1])+" svelte-jp2xja"))&&O(n,"class",e)},i(t){i||(F(d,t),i=!0)},o(t){W(d,t),i=!1},d(t){t&&w(n),d&&d.d(t),s=!1,o(r)}}}function Vt(t,n,e){let o,i,s,r,c;l(t,ft,(t=>e(9,r=t))),l(t,xt,(t=>e(11,c=t)));let{$$slots:u={},$$scope:a}=n;L();let{itemId:f=""}=n,{itemIndex:d=0}=n,p="",x={x:0,y:0},h={x:1,y:1},y=1,m=!1,$=!1,g=!1,w=!1,v={x:0,y:0};function E(t=!1){console.log(t),console.log("selected ",o.selected),(m||$)&&(t?e(10,o.selected=!o.selected,o):(Lt(),e(10,o.selected=!0,o)),xt.update((t=>t))),m=!1,$=!1}return t.$$set=t=>{"itemId"in t&&e(0,f=t.itemId),"itemIndex"in t&&e(8,d=t.itemIndex),"$$scope"in t&&e(14,a=t.$$scope)},t.$$.update=()=>{512&t.$$.dirty&&e(4,y=r),2304&t.$$.dirty&&e(10,o=c[d]),1024&t.$$.dirty&&e(2,x=o.position),1024&t.$$.dirty&&e(3,h=o.scale),1024&t.$$.dirty&&e(12,i=o.selected),1024&t.$$.dirty&&e(13,s=o.inSelectionRange),12288&t.$$.dirty&&e(1,p=i?"root selected":s?"root test":"root selectable")},[f,p,x,h,y,function(t){_t(St[t.button]),Ot(yt.SELECT)&&(m=!0),Ot(yt.SELECT_ADDITIVE)&&($=!0),Ot(yt.MOVE)&&(g=!0,v={x:t.clientX,y:t.clientY})},function(t){if(!w){let n=Et.subtractEach({x:t.clientX,y:t.clientY},v);Et.getLength(n)>20&&(w=!0)}Ot(yt.MOVE)&&g&&w&&(i||(Lt(),e(10,o.selected=!0,o)),function(t,n){for(let e of c.filter((t=>1==t.selected))){let o=Et.multiplyBoth({x:t,y:n},1/r);e.position=Et.addEach(e.position,o)}xt.update((t=>t))}(t.movementX/devicePixelRatio,t.movementY/devicePixelRatio),m=!1,$=!1)},function(t){Ot(yt.MOVE)||(g=!1,w=!1),!Ot(yt.SELECT)&&m&&E(!1),!Ot(yt.SELECT_ADDITIVE)&&$&&E(!0)},d,r,o,c,i,s,a,u]}class Yt extends nt{constructor(t){super(),tt(this,t,Vt,Nt,s,{itemId:0,itemIndex:8})}}function Rt(t,n,e){const o=t.slice();return o[34]=n[e],o[36]=e,o}function Ut(t){let n,e,o;var i=t[34].component;return i&&(n=new i({})),{c(){n&&H(n.$$.fragment),e=S()},m(t,i){n&&J(n,t,i),g(t,e,i),o=!0},p(t,o){if(i!==(i=t[34].component)){if(n){G();const t=n;W(t.$$.fragment,1,0,(()=>{K(t,1)})),q()}i?(n=new i({}),H(n.$$.fragment),F(n.$$.fragment,1),J(n,e.parentNode,e)):n=null}},i(t){o||(n&&F(n.$$.fragment,t),o=!0)},o(t){n&&W(n.$$.fragment,t),o=!1},d(t){n&&K(n,t),t&&w(e)}}}function zt(t){let n,e;return n=new Yt({props:{itemId:t[34].id,itemIndex:t[36],$$slots:{default:[Ut]},$$scope:{ctx:t}}}),n.$on("clearselection",Lt),{c(){H(n.$$.fragment)},m(t,o){J(n,t,o),e=!0},p(t,e){const o={};8&e[0]&&(o.itemId=t[34].id),8&e[0]|64&e[1]&&(o.$$scope={dirty:e,ctx:t}),n.$set(o)},i(t){e||(F(n.$$.fragment,t),e=!0)},o(t){W(n.$$.fragment,t),e=!1},d(t){K(n,t)}}}function Zt(t){let n,e,i,s,r,c,l,u,a,f,d;s=new Ct({props:{}}),t[13](s),c=new Bt({});let p=t[3],x=[];for(let n=0;n<p.length;n+=1)x[n]=zt(Rt(t,p,n));const h=t=>W(x[t],1,1,(()=>{x[t]=null}));return{c(){n=v("div"),e=v("div"),i=S(),H(s.$$.fragment),r=S(),H(c.$$.fragment),l=S(),u=v("div");for(let t=0;t<x.length;t+=1)x[t].c();O(e,"id","background"),O(e,"class","svelte-dz3b1p"),O(u,"id","contents"),I(u,"transform","translate("+t[0].x+"px,"+t[0].y+"px)scale("+t[1]+","+t[1]+")"),O(u,"class","svelte-dz3b1p"),O(n,"id","canvas"),O(n,"class","svelte-dz3b1p")},m(o,p){g(o,n,p),$(n,e),$(n,i),J(s,n,null),$(n,r),J(c,n,null),$(n,l),$(n,u);for(let t=0;t<x.length;t+=1)x[t].m(u,null);a=!0,f||(d=[_(e,"mousedown",t[4]),_(n,"mousedown",t[5]),_(n,"wheel",t[6])],f=!0)},p(t,n){if(s.$set({}),8&n[0]){let e;for(p=t[3],e=0;e<p.length;e+=1){const o=Rt(t,p,e);x[e]?(x[e].p(o,n),F(x[e],1)):(x[e]=zt(o),x[e].c(),F(x[e],1),x[e].m(u,null))}for(G(),e=p.length;e<x.length;e+=1)h(e);q()}(!a||3&n[0])&&I(u,"transform","translate("+t[0].x+"px,"+t[0].y+"px)scale("+t[1]+","+t[1]+")")},i(t){if(!a){F(s.$$.fragment,t),F(c.$$.fragment,t);for(let t=0;t<p.length;t+=1)F(x[t]);a=!0}},o(t){W(s.$$.fragment,t),W(c.$$.fragment,t),x=x.filter(Boolean);for(let t=0;t<x.length;t+=1)W(x[t]);a=!1},d(e){e&&w(n),t[13](null),K(s),K(c),function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(x,e),f=!1,o(d)}}}function Gt(){}function qt(t,n,e){let o,i,s,r,c,u,a,f,p;function x(t){Ot(mt.PAN)&&(t.clientX,t.clientY,v=!0,console.log("panstart"))}function h(){v&&Ot(mt.PAN)&&(v=!1)}l(t,ut,(t=>e(15,i=t))),l(t,at,(t=>e(16,s=t))),l(t,ft,(t=>e(17,u=t))),l(t,dt,(t=>e(18,a=t))),l(t,xt,(t=>e(3,f=t))),document.addEventListener("keydown",(function(t){let n=Dt(t.key);if(t.repeat)return;_t(n),function(t){let n=wt.filter((t=>t.operation.startsWith("shortcut")));for(let e=0;e<n.length;e++)if(n[e].input.toString()==ht.toString()){try{n[e].onDown()}catch(t){console.error(ht)}It(0,t)}}(t),x(t)})),document.addEventListener("keyup",(function(t){t.preventDefault();let n=Dt(t.key);Tt(t),Mt(n),h()})),window.addEventListener("focus",Gt),window.addEventListener("blur",(function(){Tt(null),ht.splice(0,ht.length)})),document.addEventListener("mousedown",(function(t){_t(St[t.button])})),document.addEventListener("mouseup",(function(t){Mt(St[t.button]),h()})),document.addEventListener("mousemove",(function(t){!function(t){v&&Ot(mt.PAN)&&(n=t.movementX,o=t.movementY,e(9,y.x=y.x+n/devicePixelRatio,y),e(9,y.y=y.y+o/devicePixelRatio,y),m.update((t=>y)));var n,o}(t)}));let y={x:0,y:0};const m=rt({x:0,y:0},{stiffness:1,damping:1,precision:1e-4});l(t,m,(t=>e(11,r=t)));let $={x:0,y:0,s:1};const g=rt({x:0,y:0,s:1},{stiffness:.2,damping:1,precision:1e-4});l(t,g,(t=>e(12,c=t)));let w={x:0,y:0},v=!1;function E(t){e(10,$.s=$.s+t*$.s*.1,$),g.update((t=>$))}return t.$$.update=()=>{1536&t.$$.dirty[0]&&d(ut,i=Et.addEach(y,{x:$.x,y:$.y}),i),1024&t.$$.dirty[0]&&d(at,s=$.s,s),6144&t.$$.dirty[0]&&e(0,w={x:r.x+c.x,y:r.y+c.y}),4096&t.$$.dirty[0]&&e(1,o=c.s),2&t.$$.dirty[0]&&d(ft,u=o,u),1&t.$$.dirty[0]&&d(dt,a=w,a)},[w,o,p,f,function(t){_t(St[t.button]),Ot(mt.BOX_SELECT)&&p.backgroundStartBoxSelection(t.clientX,t.clientY,!1),Ot(mt.BOX_SELECT_ADDITIVE)&&p.backgroundStartBoxSelection(t.clientX,t.clientY,!0)},function(t){_t(St[t.button]),x(t)},function(t){switch(-1*(n=t.deltaY,o=-1,i=1,Math.min(Math.max(n,o),i))){case-1:_t("scrollDown");break;case 1:_t("scrollUp")}var n,o,i;const s=vt(t.clientX,t.clientY);!function(){Ot(mt.ZOOM_IN)&&E(2);Ot(mt.ZOOM_OUT)&&E(-2)}(),Mt("scrollDown"),Mt("scrollUp");const r=vt(t.clientX,t.clientY,null,null,$.s);let c=Et.multiplyBoth(Et.subtractEach(r,s),$.s);var l,u;l=c.x,u=c.y,e(10,$.x=$.x+l,$),e(10,$.y=$.y+u,$),g.update((t=>$))},m,g,y,$,r,c,function(t){C[t?"unshift":"push"]((()=>{p=t,e(2,p)}))}]}class Ft extends nt{constructor(t){super(),tt(this,t,qt,Zt,s,{},[-1,-1])}}function Wt(n){let e,i,s,r,c;return i=new Ft({}),{c(){e=v("main"),H(i.$$.fragment)},m(t,o){g(t,e,o),J(i,e,null),s=!0,r||(c=[_(e,"contextmenu",M(n[0])),_(e,"drag",M(n[1])),_(e,"dragstart",M(n[2])),_(e,"dragenter",M(n[3]))],r=!0)},p:t,i(t){s||(F(i.$$.fragment,t),s=!0)},o(t){W(i.$$.fragment,t),s=!1},d(t){t&&w(e),K(i),r=!1,o(c)}}}function Ht(t){return[function(n){k(t,n)},function(n){k(t,n)},function(n){k(t,n)},function(n){k(t,n)}]}return new class extends nt{constructor(t){super(),tt(this,t,Ht,Wt,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
